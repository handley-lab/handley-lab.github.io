---
layout: post
title:  "Nested sampling cross-checks using order statistics"
date:   2020-06-05
categories: papers
---
![AI generated image](/assets/images/posts/2020-06-05-2006.03371.png)

<!-- BEGINNING OF GENERATED POST -->
In the paper *Nested sampling cross-checks using order statistics* ([2006.03371](https://arxiv.org/abs/2006.03371)), lead author Andrew Fowlie, along with [Will Handley](https://willhandley.co.uk) and Liangliang Su, introduce a powerful and elegant new method for validating the results of Nested Sampling (NS) runs. Nested Sampling, first introduced by John Skilling ([10.1063/1.1835238](https://doi.org/10.1063/1.1835238)), has become an indispensable algorithm for Bayesian inference, particularly for computing the Bayesian evidence required for model selection in cosmology, astrophysics, and particle physics. However, the reliability of its results hinges on a critical assumption that can sometimes fail silently.

### The Challenge: Ensuring Correct Sampling

The core of the NS algorithm is an iterative process that explores a model's parameter space by maintaining a set of "live points." At each step, the point with the lowest likelihood is discarded and replaced by a new point drawn from the prior, but constrained to have a higher likelihood than the discarded point. The main numerical challenge in any NS implementation is to perform this constrained sampling efficiently and correctly.

Popular codes like `MultiNest` ([10.1111/j.1365-2966.2009.14548.x](https://doi.org/10.1111/j.1365-2966.2009.14548.x)) and `PolyChord` ([10.1093/mnrasl/slv047](https://doi.org/10.1093/mnrasl/slv047)) employ sophisticated sub-algorithms for this task. However, in complex, high-dimensional problems or in likelihoods with unusual features like plateaus ([2005.08602](https://arxiv.org/abs/2005.08602)), these sub-algorithms can fail. This can lead to new points not being sampled uniformly from the available prior volume, breaking a fundamental assumption of NS and producing biased, unreliable evidence estimates.

### An Elegant Solution from Order Statistics

This is where the paper's key innovation provides a crucial diagnostic. The authors identify a previously unused property of NS rooted in order statistics:
*   **The Insertion Index:** When a new live point is generated, its likelihood value determines its rank, or "insertion index," within the existing, sorted set of live points.
*   **The Uniformity Principle:** For a correctly functioning NS run, this sequence of insertion indexes must be uniformly distributed. Any significant deviation from a uniform distribution is a clear statistical red flag, indicating that the sampling process has failed.

This simple but profound observation allows for the creation of a powerful cross-check that can be applied to a single NS run, without needing to know the analytic answer or perform multiple, expensive runs for comparison. The authors implement this as a Kolmogorov-Smirnov (KS) test on the sequence of insertion indexes, even proposing a "rolling p-value" to detect transient failures that might occur during a long run.

### Putting the Test into Practice

To demonstrate the method's effectiveness, the paper applies the cross-check to a range of scenarios:
*   **Stress-Testing with Toy Functions:** The test is validated against NS runs on several challenging toy functions (Gaussian, Rosenbrock, shells, and a Gaussian-Log-Gamma mixture) in dimensions ranging from 2 to 50. The results show that the insertion index test successfully flags runs where the sampling algorithm is known to fail, producing biased evidence estimates that might otherwise go unnoticed.
*   **Validating Real-World Cosmological Results:** In a compelling practical application, the authors apply their cross-check to the publicly available NS results from a study on the evidence for a spatially closed Universe ([1908.09139](https://arxiv.org/abs/1908.09139)). The test finds no evidence of sampling failures, thereby strengthening the confidence in the original scientific conclusions of that work.

Given its simplicity and power, the authors recommend that this insertion index cross-check become a mandatory diagnostic for all applicable NS runs. Looking forward, they speculate that this new insight could lead to even more significant advancements, such as using the information within the insertion indexes to actively correct, or "debias," a faulty run, paving the way for more robust and reliable Bayesian inference across the physical sciences.
<!-- END OF GENERATED POST -->

<img src="/assets/group/images/will_handley.jpg" alt="Will Handley" style="width: auto; height: 25vw;">

Content generated by [gemini-2.5-pro](https://deepmind.google/technologies/gemini/) using [this prompt](/prompts/content/2020-06-05-2006.03371.txt).

Image generated by [imagen-3.0-generate-002](https://deepmind.google/technologies/gemini/) using [this prompt](/prompts/images/2020-06-05-2006.03371.txt).