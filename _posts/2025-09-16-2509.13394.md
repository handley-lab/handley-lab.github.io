---
layout: post
title:  "Bayesian Anomaly Detection for Ia Cosmology: Automating SALT3 Data Curation"
date:   2025-09-16
categories: papers
---
![AI generated image](/assets/images/posts/2025-09-16-2509.13394.png)

<!-- BEGINNING OF GENERATED POST -->
Type Ia supernovae (SNe Ia) are cornerstones of modern cosmology, providing the crucial standardisable candles that led to the discovery of the Universe's accelerating expansion. In a new paper, [2509.13394](https://arxiv.org/abs/2509.13394), our group introduces a sophisticated Bayesian framework to automate the critical process of data curation for SNe Ia light curves, a vital step for ensuring the precision needed for next-generation cosmological analyses. As we enter an era of unprecedented data volumes from surveys like the Vera C. Rubin Observatory's Legacy Survey of Space and Time (LSST), traditional methods of manually inspecting and cleaning datasets are becoming entirely impractical. The work, led by [S. A. K. Leeney](https://github.com/samleeney) along with [W. J. Handley](https://willhandley.co.uk), [H. T. J. Bevins](https://htjb.github.io/), and [E. de Lera Acedo](https://www.phy.cam.ac.uk/directory/dr-eloy-de-lera-acedo), tackles this challenge head-on by embedding anomaly detection directly into the statistical heart of the analysis.

### A Principled Approach to Imperfect Data

Current SNe Ia analyses often rely on subjective, manual decisions to reject anomalous photometric measurements or entire bandpasses. This not only introduces potential biases but also lacks the scalability required for the millions of supernovae LSST is expected to observe ([10.3847/1538-4357/ab042c](https://doi.org/10.3847/1538-4357/ab042c)). Our framework provides an automated, objective, and reproducible alternative.

The core of our method, adapted from techniques developed for 21cm cosmology ([2211.15448](https://arxiv.org/abs/2211.15448)), is to treat the quality of each data point as a latent variable to be inferred. Instead of making a hard decision to keep or reject a measurement, our model calculates the posterior probability that each point is an anomaly. This is achieved by reformulating the likelihood to include two competing models for each data point:
*   A **"good" model**, where the data point is described by the physical supernova model (in this case, the widely-used SALT3 model).
*   A **"bad" model**, which treats the data point as a contaminant, described by a broad, uninformative distribution.

By marginalising over all possible combinations of good and bad data points, the framework simultaneously infers the supernova's physical parameters while probabilistically identifying and down-weighting outliers. To make this computationally intensive process feasible for large datasets, the entire framework is implemented on GPUs using the `JAX-bandflux` library.

### Key Capabilities and Findings

Applying this framework to the Hawaii Supernova Flows dataset, we demonstrated three principal advantages over traditional data curation:

1.  **Robust Outlier Mitigation:** The model effectively identifies and mitigates the influence of isolated, sporadic outliers that could otherwise skew parameter estimates.
2.  **Automated Filter Rejection:** In cases where an entire photometric bandpass is corrupted, the framework automatically identifies every data point within it as anomalous, replicating the decision an expert analyst would make without any manual intervention.
3.  **Enhanced Data Preservation:** Perhaps most significantly, the method can flag specific anomalous points within an otherwise useful filter. This "filter preservation" retains valid data that would be discarded in an all-or-nothing rejection scheme, leading to more precise and robust parameter constraints.

Beyond simply cleaning the data, our analysis quantified the systematic biases introduced by these anomalies. We found that contaminating data points are systematically **brighter and bluer** than the underlying supernova model would predict. If left uncorrected, this bias would lead to an underestimation of dust extinction. Through the well-known Tripp relation, this would systematically lower the inferred distance moduli, making supernovae appear closer than they are and potentially biasing key cosmological measurements, including the dark energy equation of state and the Hubble constant.

This work represents a critical step towards building fully autonomous, end-to-end analysis pipelines for precision cosmology. While demonstrated with the SALT3 model ([10.3847/1538-4357/ac30d8](https://doi.org/10.3847/1538-4357/ac30d8)), the framework's model-agnostic design makes it a versatile tool for any likelihood-based analysis. By embedding data quality assessment within the core statistical model, we can build a more robust, efficient, and powerful foundation for the coming era of data-driven cosmological discovery.
<!-- END OF GENERATED POST -->

<img src="/assets/group/images/sam_leeney.jpg" alt="S. A. K. Leeney" style="width: auto; height: 16vw;"><img src="/assets/group/images/will_handley.jpg" alt="W. J. Handley" style="width: auto; height: 16vw;"><img src="/assets/group/images/harry_bevins.jpg" alt="H. T. J. Bevins" style="width: auto; height: 16vw;"><img src="https://www.astro.phy.cam.ac.uk/sites/default/files/styles/inline/public/images/profile/headshotlow.jpg?itok=RMrJ4zTa" alt="E. de Lera Acedo" style="width: auto; height: 16vw;">

Content generated by [gemini-2.5-pro](https://deepmind.google/technologies/gemini/) using [this prompt](/prompts/content/2025-09-16-2509.13394.txt).

Image generated by [imagen-4.0-generate-001](https://deepmind.google/technologies/gemini/) using [this prompt](/prompts/images/2025-09-16-2509.13394.txt).